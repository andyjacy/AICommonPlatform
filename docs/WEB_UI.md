# Web UI 使用指南

## 概述

Web UI 是 AI Common Platform 的交互式前端界面，提供以下功能：

- 🎯 **问答界面** - 输入自然语言问题，获得AI回答
- 📚 **知识库搜索** - 在企业知识库中搜索相关内容
- 🟢 **服务状态监控** - 实时查看所有微服务的运行状态
- ⚙️ **系统配置查看** - 查看当前系统配置
- 📝 **Prompt角色展示** - 查看可用的Prompt模板
- 🏢 **企业系统集成** - 展示已集成的企业系统
- 🔧 **Agent工具列表** - 查看可用的Agent执行工具

## 访问方式

启动服务后，在浏览器中访问：

```
http://localhost:3000
```

## 界面功能详解

### 1. 问答界面 (左侧主区域)

#### 提问
1. 在输入框中输入您的问题
2. 点击"提问"按钮或按 Enter 键
3. 系统将显示加载动画，处理您的问题
4. 回答将显示在下方的回答历史中

**示例问题：**
- "今年Q1的销售额是多少?"
- "公司有多少员工?"
- "财务预算的详细情况?"
- "有哪些客户信息?"

#### 回答历史
- 显示问题和对应的回答
- 包含置信度、执行耗时、来源等信息
- 最新的回答显示在最前面

### 2. 知识库搜索 (Tab 页面)

点击"知识库搜索"标签，可以：

1. 在搜索框中输入关键词
2. 点击"搜索"按钮
3. 查看相关文档和相似度分数
4. 了解返回结果的分类和来源

**支持的搜索词：**
- 产品名称
- 部门信息
- 客户名称
- 财务关键词

### 3. 服务状态监控 (右侧侧栏上部)

实时显示所有微服务的运行状态：

**状态指示：**
- 🟢 **绿色** (healthy) - 服务正常运行
- 🟠 **橙色** (unhealthy) - 服务响应异常
- 🔴 **红色** (offline) - 服务离线

**显示信息：**
- 服务名称
- 响应时间（单位：秒）

### 4. 系统配置 (右侧侧栏下部)

显示当前系统的配置信息：

- **环境** - 运行环境（如：生产环境）
- **界面版本** - Web UI 版本号
- **更新时间** - 最后更新时间

### 5. 可用Prompt角色 (底部网格)

展示系统中可用的 Prompt 模板角色：

- 🎭 **销售顾问** - 用于销售相关问题
- 🎭 **HR顾问** - 用于人力资源问题
- 🎭 **技术顾问** - 用于技术方案问题
- 🎭 **财务顾问** - 用于财务数据问题

### 6. 企业系统集成 (底部网格)

显示已集成的企业系统：

- ✅ **ERP 系统** - 销售、库存、订单信息
- ✅ **HRM 系统** - 员工、薪资、部门信息
- ✅ **CRM 系统** - 客户信息和销售机会
- ✅ **财务系统** - 预算和财务数据

### 7. Agent工具列表 (底部网格)

显示可用的 Agent 执行工具：

- 🔧 **ERP销售查询** - 查询ERP中的销售数据
- 🔧 **HRM员工查询** - 查询员工信息
- 🔧 **财务预算查询** - 查询预算信息

## 工作流程

### 典型的问答流程

```
用户输入问题
    ↓
Web UI 发送请求到 QA Service
    ↓
QA Service 进行意图识别和分类
    ↓
RAG Service 搜索知识库相关内容
    ↓
Agent Service 调用企业系统接口
    ↓
Prompt Service 组装Prompt模板
    ↓
LLM Service 调用语言模型生成回答
    ↓
结果返回到 Web UI 显示
```

## 快捷键和交互

### 键盘快捷键
- **Enter** - 在问答框中按 Enter 可直接提问
- **Enter** - 在搜索框中按 Enter 可直接搜索

### 鼠标交互
- **点击标签** - 切换问答和搜索视图
- **自动刷新** - 服务状态每30秒自动刷新一次

## 常见问题

### Q: 提问超时怎么办？
**A:** 
- 检查所有微服务是否正常运行（查看右侧服务状态）
- 确保网络连接正常
- 查看浏览器控制台是否有错误信息
- 尝试刷新页面重新提问

### Q: 知识库搜索没有结果怎么办？
**A:**
- 确保搜索词准确
- 尝试使用更通用的关键词
- 检查知识库中是否有相关文档
- 可以通过 API 手动上传文档

### Q: 如何添加更多知识库文档？
**A:**
1. 使用 RAG Service 的 `/api/rag/upload` 端点
2. 或直接修改数据库中的文档表
3. 重新启动 RAG Service 使新文档生效

### Q: 如何更改 Prompt 模板？
**A:**
1. 编辑 Prompt Service 中的模板配置
2. 重新启动 Prompt Service
3. Web UI 将自动显示更新的模板列表

### Q: 如何集成新的企业系统？
**A:**
1. 在 Integration Service 中添加新的接口
2. 在 Agent Service 中定义新的工具
3. 重启服务后即可使用

## 性能优化建议

1. **缓存** - 系统使用 Redis 缓存常用查询
2. **向量搜索** - Milvus 优化了相似度搜索性能
3. **异步处理** - 所有 API 调用均使用异步模式
4. **连接池** - 数据库连接通过连接池复用

## 故障排查

### 服务显示离线
```bash
# 查看 Docker 容器状态
docker-compose ps

# 查看特定服务日志
docker-compose logs -f qa_entry

# 重启服务
docker-compose restart
```

### 网页无法加载
```bash
# 检查 Web UI 服务
curl http://localhost:3000/health

# 查看 Web UI 日志
docker-compose logs -f web_ui
```

### 提问超时
```bash
# 检查所有服务健康状态
curl http://localhost:3000/api/services/status

# 查看 QA Service 日志
docker-compose logs -f qa_entry
```

## 开发和定制

### 修改 UI 样式
编辑文件：`services/web_ui/static/index.html`

### 添加新的 API 接口
编辑文件：`services/web_ui/main.py`

```python
@app.get("/api/custom/endpoint")
async def custom_endpoint():
    """自定义接口"""
    # 实现逻辑
    return {"data": "value"}
```

### 刷新页面后的变化
- 问答历史会清空（保存在内存中）
- 服务状态会重新获取
- 其他配置信息会重新加载

## 最佳实践

1. **定期检查服务状态** - 通过右侧面板监控服务健康
2. **使用清晰的问题** - 更具体的问题能得到更准确的回答
3. **善用搜索功能** - 先搜索知识库了解可用的内容
4. **保留问答历史** - 通过截屏保存重要的问答记录
5. **检查置信度** - 关注回答的置信度分数

## 技术架构

```
┌─────────────────────────────────────┐
│         Web UI (前端)                │
│   HTML5 + CSS3 + JavaScript          │
│   - 响应式设计                        │
│   - 实时状态监控                      │
│   - 异步API调用                       │
└────────────────┬────────────────────┘
                 │
        ┌────────┴────────┐
        ▼                  ▼
   ┌─────────┐         ┌─────────┐
   │ 后端API │         │ 其他    │
   │(FastAPI)│         │微服务    │
   └─────────┘         └─────────┘
```

## 相关文档

- [README.md](../README.md) - 项目概览
- [docs/API.md](docs/API.md) - 完整API文档
- [docs/ARCHITECTURE.md](docs/ARCHITECTURE.md) - 系统架构

---

**Last Updated**: 2024-01-26
**Version**: 1.0.0
